webpackJsonp([1],{CVln:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("7+uW"),i={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[e._m(0),e._v(" "),n("div"),e._v(" "),n("router-link",{attrs:{to:{name:"Home"}}},[e._v("Home")]),e._v(" "),n("router-link",{attrs:{to:"/login"}},[e._v("Login")]),e._v(" "),n("router-view"),e._v(" "),e._m(1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("header",{attrs:{id:"header"}},[t("h1",[this._v("Splootify")]),this._v(" "),t("img",{attrs:{src:"http://farm1.static.flickr.com/54/179593264_648a9524de.jpg",alt:"Splootify logo: A dog with its tongue out",width:"150",height:"200"}}),t("br")])},function(){var e=this.$createElement,t=this._self._c||e;return t("footer",{attrs:{id:"footer"}},[t("p",[this._v("Created by: Kevin Bu and Sherry Feng | "),t("a",{attrs:{href:"plan.html"}},[this._v("Project Plan")]),this._v(" | Picture Source: "),t("a",{attrs:{href:"http://www.flickr.com/photos/28481088@N00"}},[this._v("28481088@N00")]),this._v(" and "),t("a",{attrs:{href:"http://animalphotos.info/a/"}},[this._v("Animal Photos!")])])])}]};var a=n("VU/8")({name:"App"},i,!1,function(e){n("wwyT")},null,null).exports,s=n("/ocq"),r=n("fZjL"),l=n.n(r),d=n("Sazm"),c=n.n(d).a.initializeApp({apiKey:"AIzaSyBdLoyJdNa1hug8fmJVq08YQjfOjdsoyC0",authDomain:"cs290-trello-f0978.firebaseapp.com",databaseURL:"https://cs290-trello-f0978.firebaseio.com",storageBucket:"cs290-trello-f0978.appspot.com"}).database(),u=c.ref("songs/"),h=c.ref("users/"),p={name:"Home",firebase:{songs:u},data:function(){return{artist:"",song:""}},methods:{generateSong:function(){c.ref("songs").once("value").then(function(e){var t=e.val(),n=l()(t).length,o=Math.floor(Math.random()*n),i=l()(t)[o],a=t[i],s=a.artist,r=(a.downvotes,a.genre),d=a.length,c=Math.floor(d/60),u=Math.floor(d-60*c);u<10&&(u="0"+u),d=c+":"+u;a.uploads,a.upvotes;var h=a.URL,p=document.getElementById("table"),m=document.createElement("tr"),v=document.createElement("th"),g=document.createElement("th"),f=document.createElement("th"),_=document.createElement("th"),y=document.createElement("th");i=(i=(i=(i=(i=i.split("<>").join(".")).split(")(").join("#")).split("&&").join("$")).split("%%").join("[")).split("@@").join("]"),v.appendChild(document.createTextNode(i)),g.appendChild(document.createTextNode(s)),f.appendChild(document.createTextNode(r)),_.appendChild(document.createTextNode(d));var b=document.createElement("a");b.appendChild(document.createTextNode("Preview")),b.href=h,y.appendChild(b),m.appendChild(v),m.appendChild(g),m.appendChild(f),m.appendChild(_),m.appendChild(y),p.appendChild(m)})}}},m={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[this._m(0),this._v(" "),t("div",[t("button",{staticClass:"btn",attrs:{type:"button",id:"generateSong"},on:{click:this.generateSong}},[this._v("Generate a random song")]),t("br"),this._v(" "),t("br")]),this._v(" "),this._m(1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("h2",[this._v("Welcome to Splootify, your song recommendation buddy")]),this._v(" "),t("div",{attrs:{id:"description"}},[t("p",[this._v('Our web application lets you generate random songs using a crowd-sourced song database. As a guest, you will only be able to use this feature. Once you authenticate your Spotify credentials, you will be able to contribute to this database, apply filtering criteria when you generate random songs, and generate playlists through upvoting and downvoting. To log in with Spotify, click the "login" tab.')])])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("table",{staticStyle:{width:"100%"},attrs:{id:"table"}},[n("tr",[n("th",{attrs:{id:"categories"}},[e._v("Song")]),e._v(" "),n("th",{attrs:{id:"categories"}},[e._v("Artist")]),e._v(" "),n("th",{attrs:{id:"categories"}},[e._v("Genre")]),e._v(" "),n("th",{attrs:{id:"categories"}},[e._v("Length")]),e._v(" "),n("th",{attrs:{id:"categories"}},[e._v("URL")])])])}]};var v=n("VU/8")(p,m,!1,function(e){n("zbzR")},"data-v-7d4af8ea",null).exports,g={name:"Login",data:function(){return{email:""}},methods:{signIn:function(){console.log("signing..."),console.log("teehee"),window.location="https://splootserver.herokuapp.com/login"}}},f={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"login"}},[this._m(0),this._v(" "),t("p",[this._v("Please log into Spotify for full access to Splootify features.")]),this._v(" "),t("button",{staticClass:"btn btn-primary",attrs:{id:"login-button"},on:{click:this.signIn}},[this._v("Log into Spotify")])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("h2",[this._v("Welcome to Splootify, your song recommendation buddy")])])}]};var _=n("VU/8")(g,f,!1,function(e){n("CVln")},null,null).exports,y=n("gRE1"),b=n.n(y),C=(n("OAwv"),n("vwbq")),E={name:"User",firebase:{},data:function(){return{added:[],artist:"",downvoted:[],email:"",password:"",permission:"user",song:"",upvoted:"",verified:!1,viewProfile:!1,tempURL:"",tempPopularity:0,tempLength:"",tempGenre:"",users:h,uniqueID:"",dbusers:c.ref("users"),profilesongs:c.ref("users/"+this.curEmail+"/added/"),isAdmin:!1}},computed:{curEmail:function(){return this.email.split(".").join("<>")}},methods:{verifyAdmin:function(e,t){"sherrycherry123@gmail.com"!=e&&"kevin.bu@duke.edu"!=e||(console.log("email passed"),"9doggo5"==t&&(console.log("id passed"),this.isAdmin=!0)),console.log(this.isAdmin)},userprint:function(){console.log(this.users),console.log(this.profilesongs),console.log(this.curEmail),c.ref("users/"+this.curEmail+"/coins/").once("value").then(function(e){var t=e.child("remaining").val(),n=document.getElementById("coinremain"),o=document.createElement("h3");return o.appendChild(document.createTextNode("You have "+t+" coins remaining!")),n.appendChild(o),t}),c.ref("users/"+this.curEmail+"/added/").once("value").then(function(e){var t=e.val();console.log(t);var n=document.getElementById("userinfo"),o=document.createElement("h2");o.appendChild(document.createTextNode("Songs you've added:")),n.appendChild(o),e.forEach(function(e){var t=document.createElement("p");t.appendChild(document.createTextNode(e.key+" by "+e.child("artist").val())),n.appendChild(t)})}),c.ref("users/"+this.curEmail+"/upvoted/").once("value").then(function(e){var t=e.val();console.log(t);var n=document.getElementById("userinfo"),o=document.createElement("h2");o.appendChild(document.createTextNode("Songs you've upvoted:")),n.appendChild(o),e.forEach(function(e){var t=document.createElement("p");t.appendChild(document.createTextNode(e.key+" by "+e.child("artist").val())),n.appendChild(t)})})},showProfile:function(){console.log("yoyo!");var e=this.email.split(".").join("<>");return console.log(this.user.child(e)),this.user.child(e).child("added")},addSong:function(e,t){if(!1!==this.verified){this.artist=t,this.song=e;var n=document.getElementById("added"),o=document.createElement("p");o.appendChild(document.createTextNode("You successfully added "+this.song+" by "+this.artist)),n.appendChild(o);var i=this.email.split(".").join("<>"),a=0,s=1,r=0,l=e.split(".").join("<>");l=(l=(l=(l=l.split("#").join(")(")).split("$").join("&&")).split("[").join("%%")).split("]").join("@@");var d=c.ref("songs/"+l),u=this.tempGenre,h=this.tempLength,p=this.tempURL;d.once("value").then(function(e){return e.exists()&&(a=e.val().downvotes,s=e.val().uploads+1,r=e.val().upvotes),c.ref("songs/"+l).set({artist:t,downvotes:a,genre:u,length:h,uploads:s,upvotes:r,URL:p}),c.ref("users/"+i+"/added/"+l).set({artist:t,downvotes:a,genre:u,length:h,uploads:s,upvotes:r,URL:p}),!0}),this.song="",this.artist="",this.verified=!1,this.tempGenre="",this.tempLength="",this.tempURL="";var m=this.curEmail;c.ref("users/"+m+"/coins/").once("value").then(function(e){var t=e.child("remaining").val()+2;alert(t);var n={remaining:t},o={};o["/users/"+m+"/coins"]=n,c.ref().update(o);var i="<h3>You have "+t+" coins remaining!";document.getElementById("coinremain").innerHTML=i})}else alert("Please verify this song first")},verifySong:function(e,t){var n=this,o=e.replace(/\s/,"%20");o=(o=(o=o.replace(/\(/,"%28")).replace(/\)/,"%29")).replace(/'/,"%27");var i=t.replace(/\s/,"%20");i=i.replace(/'/,"%27"),console.log(o+" "+i);var a=window.location.hash.substring(20);console.log(a),fetch("https://api.spotify.com/v1/search?q=artist:"+i+"%20track:"+o+"&type=track",{headers:{Authorization:"Bearer "+a}}).then(function(e){return e.json()}).then(function(e){return n.setTrack(e)}),fetch("https://api.spotify.com/v1/search?q=artist:"+i+"&type=artist",{headers:{Authorization:"Bearer "+a}}).then(function(e){return e.json()}).then(function(e){return n.setGenre(e)})},setEmail:function(e){this.email=e,""==e&&alert("Please Authenticate"),console.log(this.email);var t=document.getElementById("hello"),n=document.createElement("h2");n.appendChild(document.createTextNode("Hello, "+this.email+"!")),t.appendChild(n)},setTrack:function(e){if(console.log(e),void 0!=e.tracks.items[0]){this.tempURL=e.tracks.items[0].external_urls.spotify,console.log(this.tempURL),this.tempPopularity=e.tracks.items[0].popularity;e.tracks.items[0].preview_url;this.tempLength=e.tracks.items[0].duration_ms/1e3,console.log(this.tempPopularity+" "+this.tempLength),""!=this.tempURL?(console.log("verified in settrack"),this.verified=!0):alert("Invalid song, please try again")}else alert("Invalid song, please try again")},setGenre:function(e){console.log(e),void 0!=e.artists.items[0]?(this.tempGenre=e.artists.items[0].genres[0],console.log(this.tempGenre)):alert("Invalid song, please try again")},generateSong:function(e,t){if(console.log(this.permission),"user"==this.permission){var n=this.email.split(".").join("<>");c.ref("users/"+n).once("value").then(function(e){var t=e.val().coins.remaining;console.log(t);var o={remaining:t-1},i={};i["/users/"+n+"/coins"]=o,c.ref().update(i);var a="<h3>You have "+t-1+" coins remaining!";document.getElementById("coinremain").innerHTML=a,console.log("success")}),c.ref("songs").once("value").then(function(e){var t=e.val(),o=l()(t).length,i=Math.floor(Math.random()*o),a=l()(t)[i],s=t[a],r=s.artist,d=(s.downvotes,s.genre),u=s.length,h=Math.floor(u/60),p=Math.floor(u-60*h);p<10&&(p="0"+p),u=h+":"+p;s.uploads,s.upvotes;var m=s.URL,v=document.getElementById("table"),g=document.createElement("tr"),f=document.createElement("th"),_=document.createElement("th"),y=document.createElement("th"),b=document.createElement("th"),C=document.createElement("th");a=(a=(a=(a=(a=a.split("<>").join(".")).split(")(").join("#")).split("&&").join("$")).split("%%").join("[")).split("@@").join("]"),f.appendChild(document.createTextNode(a)),_.appendChild(document.createTextNode(r)),y.appendChild(document.createTextNode(d)),b.appendChild(document.createTextNode(u));var E=document.createElement("a");E.appendChild(document.createTextNode("Preview")),E.href=m,C.appendChild(E);var w=document.createElement("button");w.innerHTML="Upvote",w.onclick=function(){c.ref("users/"+n+"/upvoted/"+a).set({artist:r,genre:d,length:u}),w.style.backgroundColor="green"};var j=document.createElement("button");j.innerHTML="Downvote",j.onclick=function(){c.ref("users/"+n+"/downvoted/"+a).set({artist:r,genre:d,length:u}),j.style.backgroundColor="red"},g.appendChild(f),g.appendChild(_),g.appendChild(y),g.appendChild(b),g.appendChild(w),g.appendChild(j),g.appendChild(C),v.appendChild(g)});n=this.email.split(".").join("<>");c.ref("users/"+n+"/upvoted").once("value").then(function(e){var t=e.val(),n={};l()(t).forEach(function(e){console.log(e,t[e]),t[e].genre in n?n[t[e].genre]+=1:n[t[e].genre]=1}),console.log(n);var o=b()(n),i=l()(n);console.log(o),console.log(i);C.default.select("svg").remove();var a=C.default.select("#chart").append("svg").attr("width",400).attr("height",40*o.length).selectAll("g").data(o).enter().append("g").attr("transform",function(e,t){return"translate(0,"+40*t+")"});a.append("rect").attr("width",function(e){return 25*e}).attr("height",39),a.append("text").attr("x",function(e){return 25*e}).attr("y",20).attr("dy",".35em").text(function(e,t){return i[t]+": "+e})})}else alert("You have not successfully logged in. Please do so first.")}},mounted:function(){var e=this,t=window.location.hash.substring(20);console.log(t),fetch("https://api.spotify.com/v1/me",{headers:{Authorization:"Bearer "+t}}).then(function(e){return e.json()}).then(function(t){return e.setEmail(t.email)})}},w={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{attrs:{id:"authentication"}},[n("div",{attrs:{id:"hello"}}),e._v(" "),n("button",{on:{click:e.userprint}},[e._v("View your profile")]),e._v(" "),n("div",{attrs:{id:"coinremain"}}),e._v(" "),n("div",{attrs:{id:"userinfo"}}),e._v(" "),n("p",[e._v("ADMINISTRATORS ONLY")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"email",attrs:{placeholder:"Enter your email"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.uniqueID,expression:"uniqueID"}],staticClass:"uniqueID",attrs:{placeholder:"Enter your uniqueID"},domProps:{value:e.uniqueID},on:{input:function(t){t.target.composing||(e.uniqueID=t.target.value)}}}),e._v(" "),n("button",{staticClass:"btn",attrs:{type:"button",id:"admin"},on:{click:function(t){e.verifyAdmin(e.email,e.uniqueID)}}},[e._v("Authenticate admin")]),e._v(" "),n("div",{attrs:{id:"admin"}}),e._v(" "),e.isAdmin?n("div",[n("router-link",{attrs:{to:"/admin"}},[e._v("Admin")])],1):e._e(),e._v(" "),e._m(0),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.song,expression:"song"}],staticClass:"song",attrs:{placeholder:"Enter song name"},domProps:{value:e.song},on:{input:function(t){t.target.composing||(e.song=t.target.value)}}}),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.artist,expression:"artist"}],staticClass:"artist",attrs:{placeholder:"Enter song artist"},domProps:{value:e.artist},on:{input:function(t){t.target.composing||(e.artist=t.target.value)}}}),e._v(" "),n("button",{staticClass:"btn",class:{isGreen:e.verified},attrs:{type:"button",id:"add"},on:{click:function(t){e.verifySong(e.song,e.artist)}}},[e._v("Verify song")]),e._v(" "),n("button",{staticClass:"btn",attrs:{type:"button",id:"add"},on:{click:function(t){e.addSong(e.song,e.artist)}}},[e._v("Add song")]),n("br"),e._v(" "),n("div",{attrs:{id:"added"}}),e._v(" "),n("br"),e._v(" "),n("div",[n("button",{staticClass:"btn",attrs:{type:"button",id:"generateSong"},on:{click:e.generateSong}},[e._v("Get a song recommendation")]),n("br"),e._v(" "),n("br")]),e._v(" "),n("br"),e._v(" "),e._m(1),n("br"),e._v(" "),n("br"),e._v(" "),n("div",{attrs:{id:"chart"}})])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("p",{attrs:{id:"inst"}},[this._v("How to add a song to our crowdsourced database:")]),this._v(" "),t("p",{attrs:{id:"inst"}},[this._v("First, enter the name of the song and artist")]),this._v(" "),t("p",{attrs:{id:"inst"}},[this._v("Second, click the verify button to check that your song exists. If successful, the box's text will turn green")]),this._v(" "),t("p",{attrs:{id:"inst"}},[this._v("Third, click the submit button to add it to the database. You will receive two coins for your efforts")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("table",{staticStyle:{width:"100%"},attrs:{id:"table"}},[n("tr",[n("th",{attrs:{id:"categories"}},[e._v("Song")]),e._v(" "),n("th",{attrs:{id:"categories"}},[e._v("Artist")]),e._v(" "),n("th",{attrs:{id:"categories"}},[e._v("Genre")]),e._v(" "),n("th",{attrs:{id:"categories"}},[e._v("Length")]),e._v(" "),n("th",{attrs:{id:"categories"}},[e._v("Upvote/Downvote")]),e._v(" "),n("th",{staticClass:"urlcat",attrs:{id:"categories"}},[e._v("URL")])])])}]};var j=n("VU/8")(E,w,!1,function(e){n("VI6h")},null,null).exports,x={name:"Admin",firebase:{songs:u},data:function(){return{email:"",uniqueID:"",permission:"",song:"",artist:""}},methods:{authenticate:function(e,t){console.log("authenticate test"),console.log(e),console.log(t),c.ref("songs/"+temp).set({artist:artist,downvotes:downvotesCount,genre:genre,length:length,uploads:uploadsCount,upvotes:upvotesCount,URL:URL}),c.ref("users/"+temp+"/uniqueID").once("value").then(function(e){var n=e.val();return t===n?console.log("Authenticated"):console.log("Not authenticated"),!0}),this.permission="admin"},deleteSong:function(e,t){var n=e.split(".").join("<>");n=(n=(n=(n=n.split("#").join(")(")).split("$").join("&&")).split("[").join("%%")).split("]").join("@@");var o=t.split(".").join("<>");o=(o=(o=(o=o.split("#").join(")(")).split("$").join("&&")).split("[").join("%%")).split("]").join("@@"),console.log(n),console.log(o);var i=c.ref("songs/"+n);i.once("value").then(function(e){return e.exists()?i.remove():alert("Song does not exist"),!0}),this.song="",this.artist=""}},mounted:function(){c.ref("songs").orderByKey().once("value").then(function(e){console.log(e),e.forEach(function(e){var t=e.key,n=e.child("artist").val(),o=e.child("genre").val(),i=e.child("length").val(),a=Math.floor(i/60),s=Math.floor(i-60*a);s<10&&(s="0"+s),i=a+":"+s;var r=e.child("URL").val(),l=document.getElementById("table"),d=document.createElement("tr"),c=document.createElement("th"),u=document.createElement("th"),h=document.createElement("th"),p=document.createElement("th"),m=document.createElement("th");t=(t=(t=(t=(t=t.split("<>").join(".")).split(")(").join("#")).split("&&").join("$")).split("%%").join("[")).split("@@").join("]"),c.appendChild(document.createTextNode(t)),u.appendChild(document.createTextNode(n)),h.appendChild(document.createTextNode(o)),p.appendChild(document.createTextNode(i));var v=document.createElement("a");v.appendChild(document.createTextNode("Preview")),v.href=r,m.appendChild(v),d.appendChild(c),d.appendChild(u),d.appendChild(h),d.appendChild(p),d.appendChild(m),l.appendChild(d)})})}},k={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"Admin"}},[n("h2",[e._v("Hello, Admin")]),e._v(" "),n("p",[e._v("The cumulative crowd-sourced song database is below.")]),e._v(" "),n("p",[e._v("To delete a song, enter the song and artist information below.")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.song,expression:"song"}],staticClass:"song",attrs:{placeholder:"Enter name of song"},domProps:{value:e.song},on:{input:function(t){t.target.composing||(e.song=t.target.value)}}}),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.artist,expression:"artist"}],staticClass:"artist",attrs:{placeholder:"Enter name of artist"},domProps:{value:e.artist},on:{input:function(t){t.target.composing||(e.artist=t.target.value)}}}),e._v(" "),n("button",{staticClass:"btn",attrs:{type:"button",id:"deleteSong"},on:{click:function(t){e.deleteSong(e.song,e.artist)}}},[e._v("Delete song")]),n("br"),e._v(" "),n("br"),e._v(" "),e._m(0),e._v(" "),e._m(1),n("br")])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("h2",[this._v(" All Inputted Song Data: "),t("a",{attrs:{href:"https://cs290-trello-f0978.firebaseio.com/"}},[this._v("https://cs290-trello-f0978.firebaseio.com/")])])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("table",{staticStyle:{width:"100%"},attrs:{id:"table"}},[n("tr",[n("th",{attrs:{id:"categories"}},[e._v("Song")]),e._v(" "),n("th",{attrs:{id:"categories"}},[e._v("Artist")]),e._v(" "),n("th",{attrs:{id:"categories"}},[e._v("Genre")]),e._v(" "),n("th",{attrs:{id:"categories"}},[e._v("Length")]),e._v(" "),n("th",{attrs:{id:"categories"}},[e._v("URL")])])])}]},S=n("VU/8")(x,k,!1,null,null,null).exports;o.a.use(s.a);var T=new s.a({routes:[{path:"/",name:"Home",component:v},{path:"/login",name:"Login",component:_},{path:"/user",name:"User",component:j},{path:"/admin",name:"Admin",component:S}]});o.a.config.productionTip=!1,new o.a({el:"#app",router:T,components:{App:a},template:"<App/>"})},VI6h:function(e,t){},wwyT:function(e,t){},zbzR:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.318828124700b4c5cf3a.js.map